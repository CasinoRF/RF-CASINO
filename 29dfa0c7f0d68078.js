(self["webpackChunk_canva_web"] = self["webpackChunk_canva_web"] || []).push([[5024],{

/***/ 376699:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;__web_req__(813110);__web_req__(558104);self._fe4d99ebe0d2d259646a80d250150d47 = self._fe4d99ebe0d2d259646a80d250150d47 || {};(function(__c) {var rc=__c.rc;var Gc=__c.Gc;var qt=__c.qt;var P=__c.P;var Wv=__c.Wv;var Fe=__c.Fe;var gj=__c.gj;var B=__c.B;var pe=__c.pe;var D=__c.D;var O=__c.O;
var CAb=function(a){switch(a){case 4:return O("9ND0kg");case 2:return O("ibdecg");case 7:return O("446quA");case 5:return O("j1fbqg");case 1:return O("O5i4AQ");case 6:return O("C0VHsg");case 3:return O("+IXmVg");default:throw new D(a);}},DAb=function(a){return b=>({type:"react",node:(0,__c.N)(a,{...b})})},EAb=function(a){return b=>({type:"dom",render:c=>a(b,c)})},GAb=function(a){var b,c=a.$p,d=a.content;a=a.context;__c.z("formula"===(null===d||void 0===d?void 0:null===(b=d.Pg)||void 0===b?void 0:
b.type));b=d.Pg.value;switch(b.type){case "invalid":b=b.c7;break;case "canonical":b=b.aH;break;default:throw new D(b);}__c.z(b.startsWith("="));const e=d.$u;b={type:"dom",render:h=>h.innerText=""};let f;switch(e.type){case 6:f=b;break;case 1:case 3:case 4:case 2:case 5:f=FAb(c,a,d.Gu);break;case 0:f={type:"react",node:b6(__c.iU,{label:CAb(e.error),children:b6(__c.BO,{width:"full",display:"flex",justifyContent:"center",children:b6(__c.Beb,{tone:"critical"})})})};break;default:throw new D(e);}if(!f)return b;
c=pe(__c.OS,a.attrs);d=__c.OI(a.attrs.textAlign,"formula",void 0,()=>e.type);const g={textAlign:__c.Bsa(d,c.direction),justifyContent:__c.Csa(d)};switch(f.type){case "dom":return{type:"dom",render:h=>{Object.assign(h.style,g);f.render(h)}};case "react":return{type:"react",node:b6("div",{style:g,children:f.node})};default:throw new D(f);}},FAb=function(a,b,c){var d;return null===(d=a.jaa)||void 0===d?void 0:d.call(a,{context:b,value:c})},KAb=function(a){const b=a.$p,c=a.ih;a=a.y7a;b.jaa=HAb;b.Gqa=
d=>GAb({...d,$p:b});b.Hqa=DAb(IAb({ih:c,pR:void 0}));b.Jqa=JAb(a);b.Kqa=DAb(c6)},LAb=function(a,b,c){const d=[a];for(;null!=a&&a!==b;)(a=c.next(a))&&d.push(a);return d},MAb=function({label:a,width:b,height:c,scale:d,highlight:e,selected:f}){return b6("div",{style:{width:b,height:c,transform:`scale(${d})`},className:"bx74uQ",children:b6(__c.$u,{className:d6({yiml1g:e,oYlhXA:f}),size:"small",alignment:"center",children:a})})},OAb=function({$c:a,highlight:b,scale:c,ov:d,Xm:e,GKa:f}){const g=e6(()=>{const m=
null===d||void 0===d?void 0:d.get();if(null!=m&&0!==m.length)return new __c.dE(m)},[d]),h=e(1),k=e(c),l={ssE9Tg:!a,OkifGQ:a};return b6(__c.av,{co:"light",light:"light",Kq:"light",dark:"light",children:m=>b6("div",{className:d6("ze9QCQ",l,m.className),style:{width:k,height:k},children:b6("div",{style:{width:h,height:h,transform:`scale(${c})`},className:d6("N7J3UA",l),ref:null===g||void 0===g?void 0:g.Wf,children:b6(__c.CO,{className:d6("m8CFdg",l,{G6wL4w:f,W_E0wA:b}),ariaLabel:O("ruWN9A"),children:b6(NAb,
{size:"tiny"})})})})})},QAb=function(){const a=new PAb,b=new __c.RY,c=f6(f=>{const {scale:g=1,size:h="small",GKa:k=!0}=f,l=g6(m=>a.Xm(m,h),[h]);return b6(OAb,{...f,scale:g,$c:"rtl"===f.sheet.direction,highlight:null!=f.selection&&a.bZa(f.sheet,f.selection),Xm:l,GKa:k})}),d=f6(f=>{const {scale:g=1,size:h="small"}=f,k=g6(n=>a.Xm(n,h),[h]),l=g6(n=>null!=f.selection&&a.XFa(f.selection).has(n),[f.selection]),m=g6(n=>null!=f.selection&&a.lXa(f.sheet,f.selection).has(n),[f.sheet,f.selection]);return b6(h6,
{...f,scale:g,Xm:k,gza:l,QGa:m,OO:b})}),e=f6(f=>{const {scale:g=1,size:h="small"}=f,k=g6(n=>a.Xm(n,h),[h]),l=g6(n=>null!=f.selection&&a.ZFa(f.selection).has(n),[f.selection]),m=g6(n=>null!=f.selection&&a.mXa(f.sheet,f.selection).has(n),[f.sheet,f.selection]);return b6(i6,{...f,scale:g,Xm:k,RGa:m,Cza:l,OO:b})});return{eLa:c,dLa:d,fLa:e}},RAb=function(a){const b=a.vq,c=()=>null;return __c.Kt(d=>b6(j6,{...d,vq:b,Rj:c}))},UAb=function({onScroll:a}){const b=new SAb(a);return{FF:b,R$:f6(c=>b6(TAb,{sheet:c.sheet,
FF:b,children:c.children}))}},WAb=function(a){const b=a.vq,c=a.Qd,d=a.HGa,e=({children:k})=>b6(k6,{children:k}),{FF:f,R$:g}=UAb({onScroll:a.onScroll});class h extends VAb{get GG(){const k=this.props.Ab.SD;switch(k){case "screen":return g;case "print":return e;default:throw new D(k);}}componentWillUnmount(){d.eQa(this.props.item,{Rb:this.props.Rb,Ab:this.props.Ab,Cg:this.props.Cg})}render(){d.h6a(this.props.item,{Rb:this.props.Rb,Ab:this.props.Ab,Cg:this.props.Cg});return b6(l6,{...this.props,scaleFactor:this.scaleFactor,
vq:b,Qd:c,GG:this.GG,HGa:d})}constructor(...k){super(...k);this.scaleFactor=m6(()=>{const l=this.props.item;var m=this.props.Ab,n=m.SD;m=m.zoom;switch(n){case "screen":return 1;case "print":n=d.DWa(l);if(!n)return 1;({width:n}=new __c.uw(l,n.Rb,{zoom:m}));return n/l.config.width;default:throw new D(n);}})}}return{ZMa:h,FF:f}},XAb=function(a,b){if(null!=b&&null!=b.Hc&&null!=b.Mc&&null!=b.Ie&&null!=b.mf){var c=a.qa(b.Hc),d=a.ra(b.Mc),e=a.qa(b.Ie)+b.Ie.width-c;a=a.ra(b.mf)+b.mf.height-d;return __c.Vr({top:d,
left:c,width:e,height:a})}},ZAb=function(a){const b=a.vq,c=()=>null;return d=>b6(YAb,{...d,vq:b,Rj:c})},$Ab=function(a,b,c){return a<c&&c<b},dBb=function(a,b,c,d,e){if(0===c.length||0===d.length)return[];const f=aBb(a,b,c,d,e);e=bBb(a,b,c,d,e);const g=cBb(a,b,c,d),h=a.zWa(b),k=a.YVa(b),l="rtl"===b.direction;a=f.map(m=>{var n,p,q=m.O6a,r=m.Lea,t=m.xFa;const u=m.color,w=m.weight;m=m.Qb;const x=l?-1:1,y=null===(n=g.get(n6(q,t)))||void 0===n?void 0:n.Ja;n=null===(p=g.get(n6(r,t)))||void 0===p?void 0:
p.qa;if(null!=y&&null!=n){p=B(h.get(t.xa));var A=B(k.get(q.column));q=B(k.get(r.column));t="start"===t.boundary?p.start:p.end;p=A.start;r="start"===r.boundary?q.start:q.end;return{color:u,weight:w,Qb:m,p1:new __c.vr(p+y*x,t),p2:new __c.vr(r+n*x,t),...__c.Yv((r-p)*x,m*w,y)}}}).filter(__c.ub);return[...e.map(m=>{var n,p,q=m.yta,r=m.T6a,t=m.Oea;const u=m.color,w=m.weight;m=m.Qb;const x=null===(n=g.get(n6(q,r)))||void 0===n?void 0:n.Fa;n=null===(p=g.get(n6(q,t)))||void 0===p?void 0:p.ra;if(null!=x&&null!=
n){p=B(k.get(q.column));var y=B(h.get(r.xa));r=B(h.get(t.xa));q="start"===q.boundary?p.start:p.end;p=y.start;t="start"===t.boundary?r.start:r.end;return{color:u,weight:w,Qb:m,p1:new __c.vr(q,p+x),p2:new __c.vr(q,t+n),...__c.Yv(t-p,m*w,x)}}}).filter(__c.ub),...a]},eBb=function(a){const b=[];a=a.filter(c=>0!==c.weight&&null!=c.color);a=__c.qd(a,c=>c.weight);a=Array.from(a.entries()).sort(([c],[d])=>c-d);for(const [c,d]of a){a=__c.qd(d,e=>`${e.Si}_${e.Ti}`);for(const [,e]of a){const {Ti:f,Si:g}=e[0];
a=__c.qd(e,h=>h.color);for(const [h,k]of a)b.push({weight:c,color:h,lines:k,Si:g,Ti:f})}}return b},gBb=function(a,b,c,d){var e=fBb;b=b.flatMap(f=>a.rows.last()===f?[{xa:f,boundary:"start"},{xa:f,boundary:"end"}]:[{xa:f,boundary:"start"}]);c=c.flatMap(f=>a.cols.last()===f?[{column:f,boundary:"start"},{column:f,boundary:"end"}]:[{column:f,boundary:"start"}]);d=dBb(e,a,b,c,e.zQa(d));return eBb(d)},aBb=function(a,b,c,d,e){const f=[];for(const l of c)for(const m of d){c=l.xa;var g=m.column,h=gj(b.cells,
g,c);if(!h||h.span.Mc===c)if(c=o6(a.iK,b,g,c,e),c="start"===l.boundary?null===c||void 0===c?void 0:c.ra:null===c||void 0===c?void 0:c.Fa){h=f[f.length-1];g=(g=b.cols.next(g))?{column:g,boundary:"start"}:{column:B(b.cols.last()),boundary:"end"};var k;if(k=h)k=h.Lea,k=k.column===m.column&&k.boundary===m.boundary;k&&(k=h.xFa,k=k.xa===l.xa&&k.boundary===l.boundary);k&&h.color===c.color&&h.weight===c.weight&&h.Qb===c.Qb&&0===h.Qb?h.Lea=g:f.push({xFa:l,O6a:m,Lea:g,color:c.color,weight:c.weight,Qb:c.Qb})}}return f},
bBb=function(a,b,c,d,e){const f=[];for(const l of d)for(const m of c){var g=m.xa;d=l.column;var h=gj(b.cells,d,g);if(!h||h.span.Hc===d)if(d=o6(a.iK,b,d,g,e),d="start"===l.boundary?null===d||void 0===d?void 0:d.qa:null===d||void 0===d?void 0:d.Ja){h=f[f.length-1];g=(g=b.rows.next(g))?{xa:g,boundary:"start"}:{xa:B(b.rows.last()),boundary:"end"};var k;if(k=h)k=h.yta,k=k.column===l.column&&k.boundary===l.boundary;k&&(k=h.Oea,k=k.xa===m.xa&&k.boundary===m.boundary);k&&h.color===d.color&&h.weight===d.weight&&
h.Qb===d.Qb&&0===h.Qb?h.Oea=g:f.push({yta:l,T6a:m,Oea:g,color:d.color,weight:d.weight,Qb:d.Qb})}}return f},cBb=function(a,b,c,d){const e=(p,q)=>{var r=a.iK.jRa(b);const t=r.get(p)||0;r=r.get(q)||0;return t<=r?p:q},f=new Map;if(0===c.length||0===d.length)return f;var g=[],h=b.cols.yc(d[0].column);h&&g.push({column:h,boundary:"start"});g.push(...d);(d=b.cols.next(d[d.length-1].column))&&g.push({column:d,boundary:"start"});d=[];(h=b.rows.yc(c[0].xa))&&d.push({xa:h,boundary:"start"});d.push(...c);(c=
b.rows.next(c[c.length-1].xa))&&d.push({xa:c,boundary:"start"});for(const p of g){c=(g="start"===p.boundary?p.column:void 0)?b.cols.yc(g):b.cols.last();for(const q of d){var k="start"===q.boundary?q.xa:void 0;h=k?b.rows.yc(k):b.rows.last();var l=o6(a.iK,b,g,k),m=o6(a.iK,b,g,h);k=o6(a.iK,b,c,k);var n=o6(a.iK,b,c,h);h="end"===p.boundary?null===k||void 0===k?void 0:k.Ja:null===l||void 0===l?void 0:l.qa;l="end"===q.boundary?null===m||void 0===m?void 0:m.Fa:null===l||void 0===l?void 0:l.ra;m="end"===p.boundary?
null===n||void 0===n?void 0:n.Ja:null===m||void 0===m?void 0:m.qa;k="end"===q.boundary?null===n||void 0===n?void 0:n.Fa:null===k||void 0===k?void 0:k.ra;n=__c.Vv({ra:m,Fa:h,qa:k,Ja:l},e);let r;switch(n){case "blockStart":r=m;break;case "blockEnd":r=h;break;case "inlineStart":r=k;break;case "inlineEnd":r=l;break;default:r=void 0}const {height:t,width:u}=1===(null===r||void 0===r?void 0:r.Qb)?{height:r.weight,width:r.weight}:{height:Math.max((null===k||void 0===k?void 0:k.weight)||0,(null===l||void 0===
l?void 0:l.weight)||0),width:Math.max((null===m||void 0===m?void 0:m.weight)||0,(null===h||void 0===h?void 0:h.weight)||0)};f.set(n6(p,q),__c.Sv(n,t/2,u/2))}}return f},o6=function(a,b,c,d,e){if(c&&d)return a.d5a(b,e).get(`${c.id}:${d.id}`)},hBb=function(a,b,c){var d,e=b?a.layout.attrs.get(Fe({B_:void 0,K_:void 0,G_:void 0}),b.span.Mc,b.span.Hc)||{}:void 0;if(b&&e){b=(null===c||void 0===c?void 0:null===(d=c.get(`${b.span.Hc.id}:${b.span.Mc.id}`))||void 0===d?void 0:d.Fa)||!1;d={color:a.bi.color,weight:a.bi.weight,
Qb:Wv(a.bi.vd)};c=p6(e.B_);var f=q6(e.K_);e=r6(e.G_);return null==c&&null==f&&null==e?a.Fp?void 0:{borderStyle:d,pB:!0,hidden:b}:{borderStyle:{color:null!==c&&void 0!==c?c:d.color,weight:null!==f&&void 0!==f?f:d.weight,Qb:e?Wv(e):d.Qb},pB:!1,hidden:b}}},iBb=function(a,b,c){var d,e=b?a.layout.attrs.get(Fe({C_:void 0,L_:void 0,H_:void 0}),b.span.Mc,b.span.Hc)||{}:void 0;if(b&&e){b=(null===c||void 0===c?void 0:null===(d=c.get(`${b.span.Hc.id}:${b.span.Mc.id}`))||void 0===d?void 0:d.ra)||!1;d={color:a.bi.color,
weight:a.bi.weight,Qb:Wv(a.bi.vd)};c=p6(e.C_);var f=q6(e.L_);e=r6(e.H_);return null==c&&null==f&&null==e?a.Fp?void 0:{borderStyle:d,pB:!0,hidden:b}:{borderStyle:{color:null!==c&&void 0!==c?c:d.color,weight:null!==f&&void 0!==f?f:d.weight,Qb:e?Wv(e):d.Qb},pB:!1,hidden:b}}},s6=function(a,b,c,d){if(!a.hidden&&!c.hidden){var e=a.pB?c.pB?void 0:c:a;return __c.Uv(a.borderStyle,c.borderStyle,b,d,null===e||void 0===e?void 0:e.borderStyle)}},jBb=function(a,b,c){var d,e=b?a.layout.attrs.get(Fe({D_:void 0,M_:void 0,
I_:void 0}),b.span.Mc,b.span.Hc)||{}:void 0;if(b&&e){b=(null===c||void 0===c?void 0:null===(d=c.get(`${b.span.Hc.id}:${b.span.Mc.id}`))||void 0===d?void 0:d.Ja)||!1;d={color:a.bi.color,weight:a.bi.weight,Qb:Wv(a.bi.vd)};c=p6(e.D_);var f=q6(e.M_);e=r6(e.I_);return null==c&&null==f&&null==e?a.Fp?void 0:{borderStyle:d,pB:!0,hidden:b}:{borderStyle:{color:null!==c&&void 0!==c?c:d.color,weight:null!==f&&void 0!==f?f:d.weight,Qb:e?Wv(e):d.Qb},pB:!1,hidden:b}}},kBb=function(a,b,c){var d,e=b?a.layout.attrs.get(Fe({F_:void 0,
N_:void 0,J_:void 0}),b.span.Mc,b.span.Hc)||{}:void 0;if(b&&e){b=(null===c||void 0===c?void 0:null===(d=c.get(`${b.span.Hc.id}:${b.span.Mc.id}`))||void 0===d?void 0:d.qa)||!1;d={color:a.bi.color,weight:a.bi.weight,Qb:Wv(a.bi.vd)};c=p6(e.F_);var f=q6(e.N_);e=r6(e.J_);return null==c&&null==f&&null==e?a.Fp?void 0:{borderStyle:d,pB:!0,hidden:b}:{borderStyle:{color:null!==c&&void 0!==c?c:d.color,weight:null!==f&&void 0!==f?f:d.weight,Qb:e?Wv(e):d.Qb},pB:!1,hidden:b}}},lBb=function(a,b,c){var d=b.column,
e=b.xa;if(b=gj(a.cells,d,e)){var f=d===b.span.Hc,g=d===b.span.Ie,h=e===b.span.Mc,k=e===b.span.mf;if(f||g||h||k){var l=a.rows.yc(e),m=l?gj(a.cells,d,l):void 0,n=(l=a.rows.next(e))?gj(a.cells,d,l):void 0,p=(l=a.cols.yc(d))?gj(a.cells,l,e):void 0;l=(l=a.cols.next(d))?gj(a.cells,l,e):void 0;var q=a.rows.first(),r=e===q;q=a.rows.last();q=e===q;e=a.cols.first();e=d===e;var t=a.cols.last();d=d===t;var u=hBb(a,m,c);t=iBb(a,b,c);var w;h=h?!r&&u&&t?s6(u,[...(null!==(w=null===m||void 0===m?void 0:m.span.columns)&&
void 0!==w?w:[])].map(C=>a.Lq(C)),t,[...b.span.columns].map(C=>a.Lq(C))):null===t||void 0===t?void 0:t.borderStyle:void 0;w=hBb(a,b,c);m=iBb(a,n,c);var x;k=k?!q&&w&&m?s6(w,[...b.span.columns].map(C=>a.Lq(C)),m,[...(null!==(x=null===n||void 0===n?void 0:n.span.columns)&&void 0!==x?x:[])].map(C=>a.Lq(C))):null===w||void 0===w?void 0:w.borderStyle:void 0;w=jBb(a,p,c);x=kBb(a,b,c);var y;f=f?!e&&w&&x?s6(w,[...(null!==(y=null===p||void 0===p?void 0:p.span.rows)&&void 0!==y?y:[])].map(C=>a.Lr(C)),x,[...b.span.rows].map(C=>
a.Lr(C))):null===x||void 0===x?void 0:x.borderStyle:void 0;y=jBb(a,b,c);c=kBb(a,l,c);var A;c=g?!d&&y&&c?s6(y,[...b.span.rows].map(C=>a.Lr(C)),c,[...(null!==(A=null===l||void 0===l?void 0:l.span.rows)&&void 0!==A?A:[])].map(C=>a.Lr(C))):null===y||void 0===y?void 0:y.borderStyle:void 0;return{ra:h,Fa:k,qa:f,Ja:c}}}},p6=function(a){return null==a||"inherit"===a?void 0:a},q6=function(a){return null==a||"inherit"===a?void 0:Number(a.split("px")[0])},r6=function(a){return null==a||"inherit"===a?void 0:
a.split(" ").map(b=>{b=Number(b);return 0<b?b:void 0}).filter(__c.ub)},nBb=function(a){const b={transform:"translate(-1000px, -1000px) scale(0)"},c={Xsa:b,yD:b,Ca:{},xS:{}},d=t6(()=>({style:a.jY.style||c,cV:a.cV}),({style:f,cV:g})=>{var h;Object.assign(a.qca.style,f.Xsa);Object.assign(a.WL.style,f.yD);Object.assign(a.zD.style,f.Ca);Object.assign(a.DA.style,f.xS);({textDecoration:f}=(null===(h=a.jY.style)||void 0===h?void 0:h.Ca)||{});a.zD.classList.toggle("OQx3PQ","underline"===f);a.zD.classList.toggle("_99ezUA",
"line-through"===f);a.zD.classList.toggle("kppAqQ","underline line-through"===f);a.zD.style.display=g?"none":"unset"},{fireImmediately:!0,equals:u6.structural}),e=t6(()=>a.cV?void 0:a.renderer,f=>{a.T0&&"react"!==(null===f||void 0===f?void 0:f.type)?(a.T0=void 0,a.LW.remove()):a.DA.innerHTML="";switch(null===f||void 0===f?void 0:f.type){case "react":a.T0=mBb(f.node,a.LW);a.DA.appendChild(a.LW);break;case "dom":f.render(a.DA);break;case void 0:break;default:throw new D(f);}a.cW()},{fireImmediately:!0});
return()=>{d();e()}},pBb=function(a){const b=a.yw,c=a.BG,d=new oBb(a.JX);return e=>b6(v6,{...e,BG:c,yw:b,Xga:d})},qBb=class{equals(a){return this.type===a.type&&this.sheet===a.sheet&&this.container.equals(a.container)}constructor(a,b){this.container=a;this.sheet=b;this.type="sheet-item"}},rBb=class{get sheet(){return this.container.sheet}equals(a){return this.type===a.type&&this.xa===a.xa&&this.column===a.column&&this.container.equals(a.container)}constructor(a,b,c){this.container=a;this.column=b;
this.xa=c;this.type="sheet-item-cell";this.content=B(gj(a.sheet.config.cells,b,c)).content}},sBb=class{get items(){return this.text.items}equals(a){return this.type===a.type&&this.text===a.text&&this.container.equals(a.container)}constructor(a,b){P(this,{items:__c.S});this.container=a;this.text=b;this.type="sheet-item-cell-richtext"}},IAb=({ih:a,pR:b})=>c=>(0,__c.N)(__c.pab,{...c,ih:a,pR:b}),w6=__webpack_require__(443763),b6=w6.jsx,k6=w6.Fragment,x6=w6.jsxs;var f6=__webpack_require__(736241).Pi;var y6=__webpack_require__(875604),z6=y6.Component,VAb=y6.PureComponent,e6=y6.useMemo,tBb=y6.useState,g6=y6.useCallback,uBb=y6.createRef;var A6=__webpack_require__(42782),m6=A6.Fl,u6=A6.p6,B6=A6.LO,C6=A6.aD,D6=A6.EH,t6=A6.U5;var E6=__webpack_require__(240236).gn;var vBb=__webpack_require__,wBb=vBb(993864),d6=vBb.n_x(wBb)();var xBb=__webpack_require__(358579).Z;var F6=__webpack_require__(649799),G6=F6.Om,H6=F6.YN,yBb=F6.kq;var mBb=__webpack_require__(204358).createPortal;var zBb=f6(a=>{var b,c,d="rtl"===a.sheet.direction;d={H2wykw:!d,UweldA:d};const [e]=tBb(()=>qt()),f={get:g6(()=>{var g;const h=null===e||void 0===e?void 0:null===(g=e.current)||void 0===g?void 0:g.getBoundingClientRect();var k,l;g={top:0,left:0,width:null!==(k=null===h||void 0===h?void 0:h.width)&&void 0!==k?k:0,height:null!==(l=null===h||void 0===h?void 0:h.height)&&void 0!==l?l:0};return __c.Vr(g)},[e])};return x6("div",{className:d6("nMvVqA",d),children:[x6("div",{ref:xBb(a.Sd,e),className:"_0YOFPg",
children:[b6(a.vq,{...a,viewport:f}),b6("div",{className:d6("Gdl7fQ",d),children:null===(c=a.mqa)||void 0===c?void 0:null===(b=c.get())||void 0===b?void 0:b.map((g,h)=>b6(g,{},h))})]}),"visible"===a.emb&&x6(k6,{children:[b6("div",{className:d6("_32sKQw",d),children:b6(a.WMa,{...a})}),b6("div",{className:d6("xdIsTQ",d),children:b6(a.$Ma,{...a})}),b6("div",{className:d6("rsTRSA",d),children:b6(a.YMa,{...a})})]})]})}),ABb=f6(a=>{a=a.content;__c.v("text2"===a.type||"text3"===a.type);switch(a.type){case "text2":return b6(k6,
{children:a.value.aa});case "text3":return b6(k6,{children:__c.Sp.ya(a.value).cells.aa()});default:throw new D(a);}});var HAb=EAb((a,b)=>{const c=a.value;({Qi:a}=pe(__c.Ee,a.context.attrs));const d=document.createElement("div");"wrap"===a&&(d.className="dt4Dlg",d.style.overflowWrap="break-word");d.innerText=c;b.appendChild(d)});var JAb=a=>EAb((b,c)=>{const d=b.content;b=b.context;if(d.value.isEmpty)for(;c.lastChild;)c.lastChild.remove();else({Qi:b}=pe(__c.Ee,b.attrs)),"wrap"===b&&(c=c.appendChild(document.createElement("div")),c.className="dt4Dlg"),a.render({container:c,text:d.value,Ga:void 0,writingMode:1,zd:"start",xf:BBb(d,b)})}),BBb=G6((a,b)=>{if("wrap"===b)return[];a=a.value.aa.split("\n").map(c=>c.length+1);a.pop();return a},{equals:u6.structural});var c6=class a extends z6{static A(b){P(b,{Qi:m6})}get Qi(){return pe(__c.Ee,this.props.context.attrs).Qi}render(){var b=this.props.content;const c=this.props.context;if(b.value.isEmpty)return null;b=b6(this.props.Rj,{content:b,xa:c.xa,col:c.col,Qi:this.Qi},this.key++);return"wrap"===this.Qi?b6("div",{className:"dt4Dlg",children:b}):b6(k6,{children:b})}constructor(...b){super(...b);a.A(this);this.key=0}};c6=E6([Gc],c6);var CBb=4*__c.Pu,DBb=3*__c.Pu;var PAb=class{Xm(a,b){return"large"===b?CBb*a:DBb*a}constructor(){this.bZa=G6((a,b)=>{var c,d;b=b.get();return null!=b&&a.layout.rows.count()===((null===(c=b.rows)||void 0===c?void 0:c.size)||0)&&a.layout.cols.count()===((null===(d=b.columns)||void 0===d?void 0:d.size)||0)});this.XFa=yBb(a=>{var b;return new Set((null===(b=a.get())||void 0===b?void 0:b.columns)||[])},{equals:__c.Fh});this.ZFa=yBb(a=>{var b;return new Set((null===(b=a.get())||void 0===b?void 0:b.rows)||[])},{equals:__c.Fh});this.lXa=
G6((a,b)=>{var {cells:c}=b.get()||{};if(!c||0===c.size)return new Set;b=this.XFa(b);const d=new Set;for(const e of c){c=a.layout.cells.get(e.xa,e.column);for(const f of LAb(c?c.span.Hc:e.column,c?c.span.Ie:e.column,a.layout.cols))(0===b.size||b.has(f))&&d.add(f)}return d},{equals:__c.Fh});this.mXa=G6((a,b)=>{var {cells:c}=b.get()||{};if(!c||0===c.size)return new Set;b=this.ZFa(b);const d=new Set;for(const e of c){c=a.layout.cells.get(e.xa,e.column);for(const f of LAb(c?c.span.Mc:e.xa,c?c.span.mf:
e.xa,a.layout.rows))(0===b.size||b.has(f))&&d.add(f)}return d},{equals:__c.Fh})}};var h6=class a extends z6{static A(b){P(b,{$c:m6,Co:m6,qna:m6})}get $c(){return"rtl"===this.props.sheet.direction}get Co(){var b;const c=null===(b=this.props.ov)||void 0===b?void 0:b.get();if(null!=c&&0!==c.length)return new __c.dE(c)}get qna(){var b,c,d;return null===(c=(d=this.props).gWa)||void 0===c?void 0:null===(b=c.call(d))||void 0===b?void 0:b.get()}render(){return b6(__c.av,{co:"light",light:"light",Kq:"light",dark:"light",children:this.vQa})}constructor(...b){super(...b);a.A(this);this.onMouseMove=
C6(c=>{const {onMouseMove:d,sheet:e,scale:f=1}=this.props;null===d||void 0===d?void 0:d(c,e,"column",f)});this.onMouseLeave=C6(c=>{var d,e;null===(d=(e=this.props).onMouseLeave)||void 0===d?void 0:d.call(e,c)});this.H4a=()=>{var c;const {sheet:d,QGa:e,gza:f,Xm:g,scale:h=1}=this.props;let k=-1;return b6("div",{style:void 0,className:d6("Vt2_4w",{jNbTIg:!this.$c,gtA7Dw:this.$c},{Tn3nUw:void 0}),onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,ref:null===(c=this.Co)||void 0===c?void 0:c.Wf,
children:d.cols.map(l=>{k++;return b6(EBb,{col:l,label:__c.xY(k),Sma:e,xr:f,Xm:g,scale:h},l.id)})})};this.vQa=c=>x6("div",{className:d6("xhBZaw",{jNbTIg:!this.$c,gtA7Dw:this.$c},c.className),children:[void 0,this.H4a()]})}};h6=E6([Gc],h6);
var i6=class a extends z6{static A(b){P(b,{$c:m6,Co:m6,qna:m6})}get $c(){return"rtl"===this.props.sheet.direction}get Co(){var b;const c=null===(b=this.props.ov)||void 0===b?void 0:b.get();if(null!=c&&0!==c.length)return new __c.dE(c)}get qna(){var b,c,d;return null===(c=(d=this.props).gWa)||void 0===c?void 0:null===(b=c.call(d))||void 0===b?void 0:b.get()}render(){return b6(__c.av,{co:"light",light:"light",Kq:"light",dark:"light",children:this.p5a})}constructor(...b){super(...b);a.A(this);this.onMouseMove=
C6(c=>{const {onMouseMove:d,sheet:e,scale:f=1}=this.props;null===d||void 0===d?void 0:d(c,e,"row",f)});this.onMouseLeave=C6(c=>{var d,e;null===(d=(e=this.props).onMouseLeave)||void 0===d?void 0:d.call(e,c)});this.P4a=()=>{var c;const {sheet:d,RGa:e,Cza:f,Xm:g,scale:h=1}=this.props;let k=-1;return b6("div",{style:void 0,className:d6("_93roJg",{jNbTIg:!this.$c,gtA7Dw:this.$c},{Tn3nUw:void 0}),onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,ref:null===(c=this.Co)||void 0===c?void 0:c.Wf,
children:d.rows.map(l=>{k++;return b6(FBb,{xa:l,label:`${k+1}`,Sma:e,xr:f,Xm:g,scale:h},l.id)})})};this.p5a=c=>x6("div",{className:d6("An9VeA",{jNbTIg:!this.$c,gtA7Dw:this.$c},c.className),children:[void 0,this.P4a()]})}};i6=E6([Gc],i6);
var EBb=f6(a=>{const {label:b,col:c,Sma:d,xr:e,Xm:f,scale:g=1}=a;a=f(g);const h=H6(()=>d(c)),k=H6(()=>e(c));return b6("div",{className:d6("_83Rssw","d2uLIA",{YbLr8g:h,sTqdww:k}),style:{width:c.width*g,height:a},children:b6(MAb,{label:b,width:c.width,height:f(1),scale:g,highlight:h,selected:k})})}),FBb=f6(a=>{const {label:b,xa:c,Sma:d,xr:e,Xm:f,scale:g=1}=a;a=f(g);const h=H6(()=>d(c)),k=H6(()=>e(c));return b6("div",{className:d6("_83Rssw","JhBzyw",{YbLr8g:h,sTqdww:k}),style:{width:a,height:c.height*
g},children:b6(MAb,{label:b,width:f(1),height:c.height,scale:g,highlight:h,selected:k})})});var GBb='<svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><circle stroke="currentColor" cx="6" cy="6" r="5.5"/></svg>';var HBb='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle stroke="currentColor" cx="12" cy="12" r="9.25" stroke-width="1.5"/></svg>';var NAb=__c.bU({Bm:GBb,medium:HBb});var j6=class a extends z6{static A(b){P(b,{ad:m6.struct})}constructor(...b){super(...b);a.A(this)}render(){return b6(this.props.vq,{sheet:this.props.element.config,ov:this.props.ov,ey:this.props.ey,qy:this.props.qy,scaleFactor:this.props.scaleFactor,ad:this.ad,Rj:this.props.Rj,vR:void 0,nR:void 0})}get ad(){const b=this.props.Hd,c=this.props.element.altText;return c?c.Jd&&!b?{"aria-hidden":!0}:{"aria-label":c.text}:{}}};j6=E6([Gc],j6);var IBb=class{constructor(){this.d8=new WeakMap;this.DWa=a=>this.d8.get(a);this.h6a=(a,b)=>{this.d8.set(a,b)};this.eQa=(a,b)=>{const c=this.d8.get(a);c&&c.Ab===b.Ab&&c.Rb===b.Rb&&c.Cg===b.Cg&&this.d8.delete(a)}}};var KBb=f6(a=>{const b=a.Ab,c=a.item,d=a.Cg,e=a.Rb,f=a.Qd,g=a.col,h=a.xa,k=a.content,l=a.Qi;a=a.RO;__c.v("text3"===k.type);__c.jJ(a,__c.Sp.ya(k.value),(p,q)=>__c.Sp.domain.Hb(p,q));[a]=tBb(()=>new JBb(c,e,m6(()=>b.zoom)));const m=e6(()=>new qBb(d,c),[d,c]),n=e6(()=>{var p=new rBb(m,g,h);return new sBb(p,k.value)},[m,g,h,k.value]);return b6(f,{Ab:b,Xf:n,text:k.value,Rb:a,xf:"wrap"===l?"pre-wrap":"nowrap"})}),JBb=class extends __c.HT{static A(a){P(a,{width:B6.ref,hZ:m6})}get xA(){return this.c8.xA}get hZ(){const a=
(this.Bha.width-this.c8.width)/2;return{left:-a,right:this.c8.width+a}}constructor(a,b,c){super();JBb.A(this);this.sheet=a;this.c8=b;this.zoom=c;this.width=0;this.marginWidth=void 0;this.Bha=new __c.uw(this.sheet,this.c8,{zoom:this.zoom.get()})}};var TAb=f6(({sheet:a,children:b,FF:c})=>{const d=g6(f=>{c.Dma(a,f)},[c,a]),e=g6(f=>{null!=f?c.HF.set(a,f):c.HF.delete(a)},[c,a]);return b6(__c.P$a,{direction:"rtl"===a.config.direction?"rtl":"ltr",onScroll:d,Rt:e,children:b})}),SAb=class{Dma(a,b){this.onScroll&&this.onScroll(a);this.tX.set(a,b)}constructor(a){this.onScroll=a;this.HF=new WeakMap;this.tX=B6.map(new Map,{deep:!1});this.scrollTo=C6((b,c)=>{b=this.HF.get(b);null===b||void 0===b?void 0:b.scrollTo({left:Math.floor(c)})})}};var l6=class a extends z6{static A(b){P(b,{ad:m6.struct})}render(){const b=this.props.item;return b6("div",{ref:this.props.measureRef,className:"E8r86A",style:{width:Math.min(this.props.Rb.width,b.G)},children:b6(this.props.GG,{sheet:b,children:b6("div",{ref:this.props.YXa,className:"cXTiJA",style:{width:b.G,height:b.W},children:b6(this.props.vq,{sheet:b.config,ov:this.props.ov,scaleFactor:this.props.scaleFactor,ey:this.props.ey,qy:this.props.qy,ad:this.ad,Rj:this.Rj,vR:void 0,nR:void 0})})})})}get ad(){const b=
this.props.Hd,c=this.props.item.altText;return c?c.Jd&&!b?{"aria-hidden":!0}:{"aria-label":c.text}:{}}constructor(...b){super(...b);a.A(this);this.Rj=f6(c=>b6("div",{className:"wKvivQ",children:b6(KBb,{...this.props,...c,Qd:this.props.Qd})}))}};l6=E6([Gc],l6);var LBb=f6(({page:a,range:b,Wpa:c})=>{if(null!=c){var d=XAb(a.sheet,b);return b6("div",{className:"Gi9pfA",children:a.elements.map((e,f)=>null==d?b6(c,{element:e},f):__c.Tr(__c.Vr(e)).Jo(d)&&b6(c,{element:e},f))})}});var MBb=new __c.RY,I6=a=>CBb*a,J6=()=>!1,YAb=f6(({page:a,ov:b,ey:c,qy:d,a3:e,scaleFactor:f,viewport:g,B6a:h,vq:k,Rj:l,Wpa:m,Ubb:n,Tbb:p})=>{var q="rtl"===a.sheet.direction,r;const t=null!==(r=null===f||void 0===f?void 0:f.get())&&void 0!==r?r:1;r=e6(()=>({range:w})=>x6(k6,{children:[m&&b6(LBb,{page:a,Wpa:m,range:w}),p&&b6(p,{})]}),[a,m,p]);const u=e6(()=>({range:w})=>{if(null!=w&&null!=n)return b6(n,{range:w})},[n]);b=b6(k,{sheet:a.sheet,ov:b,ey:c,qy:d,a3:e,scaleFactor:f,viewport:g,Rj:l,vR:u,nR:r});
q=x6("div",{className:"OsKKIQ",children:[b6("div",{className:"VDFv_A",children:b}),b6("div",{className:"_688KWg",children:b6(OAb,{$c:q,highlight:!1,Xm:I6,scale:t})}),b6("div",{className:"m0cT1w",children:b6(h6,{sheet:a.sheet,scale:t,Xm:I6,gza:J6,QGa:J6,OO:MBb})}),b6("div",{className:"zm537g",children:b6(i6,{sheet:a.sheet,scale:t,Xm:I6,Cza:J6,RGa:J6,OO:MBb})})]});return h?q:b});var oBb=class{constructor(a){this.JX=a;this.SPa=__c.vW;this.iWa=G6((b,c,d,e)=>{const f=[];e=this.qWa(b,c,d,e);c=(l,m)=>(l=__c.fj(b.cells,m,l))&&__c.Fsa(l);for(const {xa:l,column:m,textAlign:n,SQa:p}of e){var g=p.width+("center"===n?0:this.SPa),h=void 0;switch(n){case "start":case "justify":e=b.qa(m);h=e+g;break;case "center":h=b.qa(m)+m.width/2;e=h-g/2;h+=g/2;break;case "end":h=b.qa(m)+m.width;e=h-g;break;default:throw new D(n);}for(g=d.indexOf(m)-1;0<=g;g--){var k=d[g];if(k!==m&&!c(l,k)||!$Ab(e,
h,b.qa(k)+k.width))break;f.push({xa:l,column:k,edge:"inlineEnd"})}for(g=d.indexOf(m)+1;g<d.length;g++){k=d[g];if(k!==m&&!c(l,k)||!$Ab(e,h,b.qa(k)))break;f.push({xa:l,column:k,edge:"inlineStart"})}}return f},{equals:u6.structural});this.qWa=G6((b,c,d,e)=>{const f=[];for(const h of d)for(const k of c){var g;d=b.layout.cells.get(k,h);if(!d||!d.ref.content.ref||d.span.Mc!==d.span.mf||d.span.Hc!==d.span.Ie)continue;const {Qi:l,textAlign:m}=pe(__c.Ee,b.layout.attrs.get(Fe({Qi:void 0,textAlign:void 0}),
k,h)||{}),n=this.JX.iy(b,k,h);d=__c.OI(m,d.ref.content.ref.type,null===(g=d.ref.Ba.ref)||void 0===g?void 0:g.type,n?()=>n.$u.type:void 0);const p=e(k,h);"overflow"===l&&p&&d&&f.push({xa:k,column:h,textAlign:d,SQa:p})}return f},{equals:u6.structural})}};var n6=(a,b)=>`${a.column.id}-${a.boundary}:${b.xa.id}-${b.boundary}`,OBb=class{constructor(){this.iK=NBb;this.zQa=G6(a=>{const b=new Map;for(const {column:c,xa:d,edge:e}of a){switch(e){case "blockStart":a={ra:!0};break;case "blockEnd":a={Fa:!0};break;case "inlineStart":a={qa:!0};break;case "inlineEnd":a={Ja:!0};break;default:throw new D(e);}const f=`${c.id}:${d.id}`;b.set(f,{...b.get(f),...a})}return b});this.zWa=G6(a=>{const b=new Map;let c=0;a.rows.forEach(d=>{const e=c,f=e+d.height;b.set(d,{start:e,
end:f});c=f});return b});this.YVa=G6(a=>{const b=new Map;var c="rtl"===a.direction;const d=c?-1:1;let e=0;c&&(c=a.cols.last(),e=null!=c?a.qa(c)+c.width:0);a.cols.forEach(f=>{const g=e,h=g+f.width*d;b.set(f,{start:g,end:h});e=h});return b})}},PBb=class{constructor(){this.d5a=G6((a,b)=>{const c=new Map;for(const d of a.rows)for(const e of a.cols){const f=`${e.id}:${d.id}`,g=lBb(a,{column:e,xa:d},b);g&&c.set(f,g)}return c},{equals:u6.identity});this.jRa=G6(a=>{const b=new Map;for(const d of a.cols)for(const e of a.rows){var c=
o6(this,a,d,e);if(!c)continue;const f=c.qa,g=c.Ja,h=c.ra;c=c.Fa;f&&b.set(f.color,(b.get(f.color)||0)+1);h&&b.set(h.color,(b.get(h.color)||0)+1);g&&d===a.cols.last()&&b.set(g.color,(b.get(g.color)||0)+1);c&&e===a.rows.last()&&b.set(c.color,(b.get(c.color)||0)+1)}return b},{equals:u6.identity})}},NBb=new PBb,fBb=new OBb;var K6=class a extends z6{static A(b){P(b,{bna:m6({equals:u6.shallow}),cna:m6({equals:u6.shallow}),cza:m6({equals:u6.structural})})}componentDidMount(){const b=B(this.ref.current);rc(this,D6(()=>{var c=this.props.scaleFactor;const d=this.props.sheet;var e;c=null!==(e=null===c||void 0===c?void 0:c.get())&&void 0!==e?e:1;e=d.height;b.style.width=`${d.width*c}px`;b.style.height=`${e*c}px`}))}get bna(){const b=this.props.sheet;return[...this.props.w9a].sort((c,d)=>b.cols.Ol(c,d))}get cna(){const b=this.props.sheet;
return[...this.props.Sw].sort((c,d)=>b.rows.Ol(c,d))}get cza(){return this.props.Xga.iWa(this.props.sheet,this.cna,this.bna,this.props.hU)}render(){var b=this.props.sheet;const c=gBb(b,this.cna,this.bna,this.cza),d=b.width,e=b.height;b="rtl"===b.direction;return b6("svg",{ref:this.ref,role:"presentation",className:d6("c6a1eQ",{H_CtIQ:!b,_8_56PQ:b}),viewBox:`0 0 ${d} ${e}`,strokeLinecap:"butt",strokeLinejoin:"miter",children:c.map(({lines:f,color:g,weight:h,Si:k,Ti:l})=>b6("path",{stroke:g,strokeDasharray:k,
strokeDashoffset:l,strokeWidth:h,d:f.map(({p1:m,p2:n})=>`M ${m.x} ${m.y} L ${n.x} ${n.y}`).join(" ")},`${g}-${h}-${k}-${l}`))})}constructor(...b){super(...b);a.A(this);this.ref=uBb()}};K6=E6([Gc],K6);var M6=class a extends z6{static A(b){P(b,{j2:m6,EJa:m6})}render(){var b;const c=this.props.GVa;return x6("div",{ref:this.KGa,className:d6("ZTz_iA","ltr"===this.props.sheet.direction?"TA4X7w":"WvuqMw"),children:[(null===c||void 0===c?void 0:c.ePa)&&b6(L6,{...this.props,range:c.ePa.range,aU:!0,bU:!0,className:"_0C8M3w",o0:this.j2}),(null===c||void 0===c?void 0:c.k9a)&&b6(L6,{...this.props,range:c.k9a.range,aU:!1,bU:!0,className:"_7n44yg",o0:this.j2}),(null===c||void 0===c?void 0:c.nXa)&&b6(L6,{...this.props,
range:c.nXa.range,aU:!0,bU:!1,className:"fF5r6w",o0:this.j2}),b6(L6,{...this.props,range:null===c||void 0===c?void 0:null===(b=c.I8a)||void 0===b?void 0:b.range,aU:!1,bU:!1,className:"llILYw",o0:this.EJa})]})}componentDidMount(){const b=D6(()=>{var c=this.props,d=c.scaleFactor;c=c.sheet;const e=this.KGa.current;e&&(d=d?d.get():1,e.style.width=`${c.width*d}px`,e.style.height=`${c.height*d}px`)});rc(this,[b])}get j2(){return{type:"excluded"}}get EJa(){return{type:"hidden",SL:this.DPa}}constructor(...b){super(...b);
a.A(this);this.KGa=qt();this.DPa=(c,d)=>{var e;const f=this.props.sheet;var g=this.props.GVa;g=null===g||void 0===g?void 0:null===(e=g.I8a)||void 0===e?void 0:e.range;return null==g?!0:0<=f.cols.Ol(c,g.Hc)&&0>=f.cols.Ol(c,g.Ie)&&0<=f.rows.Ol(d,g.Mc)&&0>=f.rows.Ol(d,g.mf)}}};M6=E6([Gc],M6);
var L6=class a extends z6{static A(b){P(b,{IGa:m6})}get IGa(){const b=this.props.viewport,c=this.props.aU,d=this.props.bU;return null==b||!c&&!d?b:m6(()=>{const e=__c.cs(b.get());return __c.Vr({top:d?0:e.top,left:c?0:e.left,width:e.width,height:e.height})})}render(){const b=this.props.range,c=this.props.o0,d=this.props.vR,e=this.props.nR,f="ltr"===this.props.sheet.direction?"TA4X7w":"WvuqMw";return b6("div",{ref:this.vka,className:d6("i0YQww",this.props.className),children:x6("div",{ref:this.yDa,
children:[x6("div",{ref:this.xDa,className:"vUKoKg",children:[b6(N6,{...this.props,viewport:this.IGa,bounds:"hidden"===(null===c||void 0===c?void 0:c.type)?void 0:b,SL:"hidden"===(null===c||void 0===c?void 0:c.type)?c.SL:void 0}),b6("div",{className:d6("DC3n2A",f),children:e&&b6(e,{range:b})})]}),b6("div",{className:d6("DC3n2A",f),children:d&&b6(d,{range:b})})]})})}componentDidMount(){const b=D6(()=>{var h=this.props,k=h.scaleFactor,l=h.sheet;const m=h.range;var n=this.vka.current;const p=this.xDa.current;
h=this.yDa.current;k=k?k.get():1;const q=m?l.qa(m.Ie)+m.Ie.width-l.qa(m.Hc):l.width,r=m?l.ra(m.mf)+m.mf.height-l.ra(m.Mc):l.height;n&&(n.style.width=`${q*k}px`,n.style.height=`${r*k}px`);p&&(p.style.width=`${q*k}px`,p.style.height=`${r*k}px`);h&&(n="rtl"===l.direction,n=m?l.qa(m.Hc)*k*(n?1:-1):0,l=m?-l.ra(m.Mc)*k:0,h.style.transform=`translate(${n}px, ${l}px)`)}),c=this.props.sheet;var d=this.props.a3;const e=this.props.aU,f=this.props.bU,g=null===d||void 0===d?void 0:d(c,e,f);d=D6(()=>{const h=this.vka.current;
if(null!=h){var k=e||f?"sticky":"relative",l=f?"0px":"unset",m=e?"0px":"unset",n=e?"0px":"unset",p="rtl"===c.direction;if(null==g)h.style.position=k,h.style.top=l,h.style.left=p?"unset":m,h.style.right=p?n:"unset";else{const x=g.get();var q;h.style.position=null!==(q=x.position)&&void 0!==q?q:k;var r;h.style.top=null!==(r=x.top)&&void 0!==r?r:l;var t;h.style.left=p?"unset":null!==(t=x.left)&&void 0!==t?t:m;var u;h.style.right=p?null!==(u=x.right)&&void 0!==u?u:n:"unset";var w;h.style.transform=null!==
(w=x.transform)&&void 0!==w?w:"unset"}}});rc(this,[b,d])}constructor(...b){super(...b);a.A(this);this.vka=qt();this.yDa=qt();this.xDa=qt()}};L6=E6([Gc],L6);
var QBb=class{constructor(){this.yS=new Map;this.P9a=(a,b,c,d)=>{const e=new QBb;for(const [f,g]of this.yS)c.has(g.xa)&&e.yS.set(f,g);c=`${b.id}:${a.id}`;d?e.yS.set(c,{width:d.width,height:d.height,xa:a,column:b}):e.yS.delete(c);return e};this.hU=(a,b)=>this.yS.get(`${b.id}:${a.id}`)}},N6=class a extends z6{static A(b){P(b,{VK:B6.shallow,Co:m6,bounds:m6,Sw:m6({equals:u6.shallow}),bpa:m6({equals:u6.shallow}),Yra:C6,b1:C6.bound})}get Co(){var b;const c=null===(b=this.props.ov)||void 0===b?void 0:b.get();
if(null!=c&&0!==c.length)return new __c.dE(c)}render(){var b;return x6("div",{ref:xBb(this.Sd,null===(b=this.Co)||void 0===b?void 0:b.Wf),children:[b6("div",{ref:this.Ysa,className:"_5YlOqQ"}),b6("div",{ref:this.gta,className:"_XCmKw"}),this.VK.map(c=>c.E3a),b6(this.T$,{hU:this.state.hU})]})}componentDidMount(){const b=t6(()=>[this.bpa,this.Sw],([e,f])=>this.Yra(e,f),{fireImmediately:!0}),c=D6(()=>{var e=this.props,f=e.scaleFactor;e=e.sheet;const g=this.Sd.current;g&&(f=f?f.get():1,g.style.width=
`${e.width*f}px`,g.style.height=`${e.height*f}px`)}),d=this.VK.map(e=>nBb(e));rc(this,[c,b,...d])}get bounds(){const b=this.props.sheet,c=this.props.bounds;var d,e,f,g;return{Hc:null!==(d=null===c||void 0===c?void 0:c.Hc)&&void 0!==d?d:b.cols.first(),Ie:null!==(e=null===c||void 0===c?void 0:c.Ie)&&void 0!==e?e:b.cols.last(),Mc:null!==(f=null===c||void 0===c?void 0:c.Mc)&&void 0!==f?f:b.rows.first(),mf:null!==(g=null===c||void 0===c?void 0:c.mf)&&void 0!==g?g:b.rows.last()}}get Sw(){const b=this.bounds,
c=this.props.sheet;var d=this.props.viewport;const e=this.props.scaleFactor.get();var f=500*e,g=null===d||void 0===d?void 0:d.get();d=g?g.tl.y-f:b.Mc?c.ra(b.Mc):0;f=g?g.br.y+f:b.mf?c.ra(b.mf)+b.mf.height:0;g=new Map;for(let h=b.Mc;null!=h&&null!=b.mf&&0>=c.rows.Ol(h,b.mf);h=c.rows.next(h)){const k=c.ra(h);if(!(k+h.height<d)){if(k>f)break;g.set(h,k*e)}}return g}get bpa(){const b=this.bounds,c=this.props.sheet;var d=this.props.viewport;const e=this.props.scaleFactor.get();var f=100*e,g=null===d||void 0===
d?void 0:d.get();d=g?g.tl.x-f:b.Hc?c.qa(b.Hc):0;f=g?g.br.x+f:b.Ie?c.qa(b.Ie)+b.Ie.width:0;g=new Map;for(let h=b.Hc;null!=h&&null!=b.Ie&&0>=c.cols.Ol(h,b.Ie);h=c.cols.next(h)){const k=c.qa(h);if(!(k+h.width<d)){if(k>f)break;g.set(h,k*e)}}return g}Yra(b,c){const d=B(this.Ysa.current),e=B(this.gta.current),f=[],g=new Map;for(const h of this.yKa)c.has(h.xa)?g.set(h.xa,h):f.push(h);for(const [h,k]of c)c=g.get(h)||f.pop(),c||(c=new RBb(this.b1,h),d.appendChild(c.l0),e.appendChild(c.n0),this.yKa.push(c)),
c.update(k,h,b);for(const h of f)h.hide()}b1(b,c){const d=this.props.kda,e=this.props.sheet,f=this.props.SL;b=new SBb(this.props.BG,this.props.Rj,d(b,c),e,b,c,f,this.cW);rc(this,nBb(b));this.VK.push(b);return b}constructor(b){super(b);a.A(this);this.Sd=qt();this.Ysa=qt();this.gta=qt();this.yKa=[];this.VK=[];this.T$=f6(c=>{const d=[...this.Sw.keys()],e=[...this.bpa.keys()];return b6(this.props.VMa,{Sw:d,w9a:e,hU:c.hU})});this.cW=(c,d,e)=>{this.setState(f=>{const g=e();return f.P9a(d,c,this.Sw,g)})};
this.state=new QBb}};N6=E6([Gc],N6);
var RBb=class{static A(a){P(a,{update:C6})}update(a,b,c){[this.l0,this.n0].forEach(d=>{d.style.transform=`translateY(${a}px)`;d.classList.add("FPpqvg")});this.xa=b;for(const [d]of c)c=this.VK.get(d),c||(c=this.b1(d,b),this.VK.set(d,c),this.l0.appendChild(c.qca),this.n0.appendChild(c.WL)),c.update(b)}hide(){[this.l0,this.n0].forEach(a=>{a.style.transform="translate(-1000px, -1000px) scale(0)"})}constructor(a,b){RBb.A(this);this.b1=a;this.xa=b;this.l0=document.createElement("div");this.n0=document.createElement("div");
this.VK=new Map}},SBb=class{static A(a){P(a,{T0:B6.ref,xa:B6.ref,Ca:m6,attrs:m6,cV:m6,renderer:m6,update:C6})}get E3a(){return this.T0}get Ca(){return __c.fj(this.sheet.cells,this.col,this.xa)}get attrs(){return this.sheet.layout.attrs.get(Fe({Qi:0,textAlign:0,direction:0}),this.xa,this.col)||{}}get cV(){return this.SL?!this.SL(this.col,this.xa):!1}get renderer(){const a=this.Ca;if(a&&(a.content||a.Ba))return this.BG({context:{xa:this.xa,col:this.col,sheet:this.sheet,attrs:this.attrs},RO:this.cW,
Rj:this.Rj})}update(a){this.xa=a;this.jY.xa=a}constructor(a,b,c,d,e,f,g,h){SBb.A(this);var k,l,m,n,p,q;this.BG=a;this.jY=c;this.sheet=d;this.col=e;this.SL=g;this.qca=document.createElement("div");this.WL=document.createElement("div");this.zD=document.createElement("div");this.DA=document.createElement("div");this.LW=document.createElement("div");this.J_a=()=>{if(this.renderer){var r="react"===this.renderer.type?this.LW:this.DA;if(0!==r.childNodes.length&&(r=r.childNodes[0],r instanceof HTMLElement))return{width:r.clientWidth,
height:r.clientHeight}}};this.xa=f;this.qca.className="_2JFriw";this.WL.className="imy9ug";this.zD.className=d6("pDMp7w",{_0yZ6Qg:"text3"!==(null===(l=this.Ca)||void 0===l?void 0:null===(k=l.content)||void 0===k?void 0:k.type),qhF5uA:"text3"!==(null===(n=this.Ca)||void 0===n?void 0:null===(m=n.content)||void 0===m?void 0:m.type)&&"text2"!==(null===(q=this.Ca)||void 0===q?void 0:null===(p=q.content)||void 0===p?void 0:p.type)});this.DA.className="_30B9pw";this.zD.appendChild(this.DA);this.WL.appendChild(this.zD);
this.LW.className="G7zH2w";this.cW=()=>{h(this.col,this.xa,this.J_a)};this.Rj=r=>b6(b,{...r,RO:this.cW})}};var v6=class extends z6{render(){const a=this.props.sheet,b=this.props.ov,c=this.props.a3,d=this.props.BG,e=this.props.ad,f=this.props.Rj,g=this.props.viewport,h=this.props.vR,k=this.props.nR;return b6("div",{className:d6("SNkrHw","ltr"===a.direction?"TA4X7w":"WvuqMw"),...e,children:b6(M6,{BG:d,Rj:f,VMa:this.T$,kda:this.kda,sheet:a,ov:b,a3:c,scaleFactor:this.scaleFactor,viewport:g,vR:h,nR:k})})}get scaleFactor(){return this.props.scaleFactor?this.props.scaleFactor:m6(()=>1)}constructor(...a){super(...a);
this.T$=f6(b=>b6(K6,{...b,sheet:this.props.sheet,scaleFactor:this.scaleFactor,Xga:this.props.Xga}));this.kda=(b,c)=>new __c.Msa(this.props.yw,this.props.sheet,b,c,this.scaleFactor,this.ey,this.qy);this.ey=(b,c)=>{var d,e;return null===(d=(e=this.props).ey)||void 0===d?void 0:d.call(e,this.props.sheet,b,c)};this.qy=(b,c)=>{var d,e;return null===(d=(e=this.props).qy)||void 0===d?void 0:d.call(e,this.props.sheet,b,c)}}};v6=E6([Gc],v6);__c.Rsa={hYa:function(a){const b=a.Sl,c=a.Gd,d=a.kc,e=a.jk,f=a.JX,g=a.yw,h=a.BR;KAb({$p:a.$p,ih:a.ih,y7a:a.$J});const k=pBb({BG:h,JX:f,yw:g});b.naa=ZAb({vq:k});c.U$=RAb({vq:k});({ZMa:a}=WAb({vq:k,Qd:e(),HGa:new IBb}));d.Km.maa=a;const {eLa:l,fLa:m,dLa:n}=QAb();return{wqa:f6(p=>b6(zBb,{...p,vq:k,YMa:l,$Ma:m,WMa:n,Rj:ABb}))}}};
}).call(self, self._fe4d99ebe0d2d259646a80d250150d47);}

}])
//# sourceMappingURL=sourcemaps/29dfa0c7f0d68078.js.map